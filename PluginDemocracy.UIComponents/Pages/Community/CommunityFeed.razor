@inject Services Services
@inject BaseAppState AppState

@foreach (CommunityDto community in AppState.User?.Citizenships ?? new List<CommunityDto>())
{
    <MudText>Community: @community.FullName</MudText>
}

@code {

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        //if AppState.PDAPIResponse.LastRefreshed is older than 30 seconds, refresh user data
        if (AppState.PDAPIResponse.LastRefreshed < DateTime.UtcNow.AddSeconds(-30)) await Services.GetDataAsync(ApiEndPoints.RefreshUserData);
        //If user doesn't have any communities, redirect to JoinOrRegisterCommunity page
        if (AppState.User?.Citizenships.Count == 0) Services.NavigateTo(FrontEndPages.JoinOrRegisterCommunity);
    }

}
