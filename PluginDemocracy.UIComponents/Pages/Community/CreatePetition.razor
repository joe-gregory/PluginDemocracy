@inject Services Services
@inject BaseAppState AppState
@using Microsoft.AspNetCore.Components.Forms

<MudText Typo="Typo.h3" Align="Align.Center" Class="mb-5">@AppState.Translate(ResourceKeys.CreatePetition)</MudText>
<MudCard Elevation="25">
    <MudText>@AppState.Translate(ResourceKeys.CreatePetitionDescription)</MudText>
</MudCard>

<MudCard Elevation="25">
    @if (AppState?.User?.Citizenships.Count > 1)
    {
        <MudSelect @bind-Value="Petition.CommunityDTO" Label="@(AppState.Translate(ResourceKeys.Community))">
            @foreach (CommunityDTO community in AppState.User.Citizenships)
            {
                <MudSelectItem Value="@community">@community.Name</MudSelectItem>
            }
        </MudSelect>
    }
    else
    {
        <MudField Label="@AppState?.Translate(ResourceKeys.Community)" Variant="Variant.Outlined">@Petition.CommunityDTO?.Name</MudField>
    }
</MudCard>

<MudCard Elevation="25">
    <MudTextField @bind-Value="Petition.Title" Label="@AppState.Translate(ResourceKeys.Title)" Variant="Variant.Outlined" Class="mt-5" HelperText="@AppState.Translate(ResourceKeys.PetitionTitle)" Required="true"/>
    <MudTextField @bind-Value="Petition.Description" Label="@AppState.Translate(ResourceKeys.Description)" Variant="Variant.Outlined" Class="mt-5" Lines="10" AutoGrow HelperText="@AppState.Translate(ResourceKeys.PetitionDescription)" Required="true"/>
    <MudTextField @bind-Value="Petition.ActionRequested" Label="@AppState.Translate(ResourceKeys.ActionRequested)" Variant="Variant.Outlined" Class="mt-5" Lines="10" AutoGrow HelperText="@AppState.Translate(ResourceKeys.ActionRequestedDescription)" Required="true"/>
    <MudTextField @bind-Value="Petition.SupportingArguments" Label="@AppState.Translate(ResourceKeys.SupportingArguments)" Variant="Variant.Outlined" Class="mt-5" Lines="10" AutoGrow HelperText="@AppState.Translate(ResourceKeys.SupportingArgumentsDescription)" Required="true" />
    <MudTextField @bind-Value="Petition.DeadlineForResponse" Format="yyyy-MM-dd" Label="@AppState.Translate(ResourceKeys.DeadlineForResponse)" InputType="InputType.Date" HelperText="@AppState.Translate(ResourceKeys.DeadlineForResponseDescription)"/>
</MudCard>

<MudCard Elevation="25">
    <MudText Typo="Typo.h5" Class="mb-5">@AppState.Translate(ResourceKeys.SupportingDocuments)</MudText>
    <MudText Class="m-1">@AppState.Translate(ResourceKeys.SupportingDocumentsDescription)</MudText>
    <MudFileUpload T="IReadOnlyList<IBrowserFile>" FilesChanged="UploadFiles">
        <ButtonTemplate>
            <MudButton HtmlTag="label"
                       Variant="Variant.Filled"
                       Color="Color.Primary"
                       StartIcon="@Icons.Material.Filled.CloudUpload"
                       for="@context.Id">
                @AppState.Translate(ResourceKeys.SupportingDocuments)
            </MudButton>
        </ButtonTemplate>
    </MudFileUpload>
</MudCard>