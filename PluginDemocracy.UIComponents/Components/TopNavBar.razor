@inject BaseAppState AppState

<MudAppBar Elevation="1">
    <MudIconButton Icon="@PluginDemocracyIcons.CommunityIcon" Color="Color.Inherit" Edge="Edge.Start" OnClick="@ToggleCommunityMenu" Disabled="@CommunityMenuButtonDisabled" />
    <MudSpacer />
    <MudIcon Icon="@PluginDemocracyIcons.CommunityIcon" Color="Color.Inherit"/>
    <MudSpacer />
    <MudAvatar @onclick="@ToggleUserMenu" Class="@(UserMenuButtonDisabled ? "mud-avatar-disabled" : "")">
        @if (AppState.User != null)
        {
            if (!string.IsNullOrEmpty(AppState.User.ProfilePicture))
            {
                <MudImage Src=@AppState.User.ProfilePicture />
            }
            else
            {
                <MudText Color="Color.Primary">@AppState.User.Initials</MudText>
            }

        }
        else
        {
            <MudIcon Icon="@Icons.Material.Filled.Person" Color="Color.Primary" />

        }
    </MudAvatar>
</MudAppBar>

<MudDrawer @bind-Open="@communityMenuOpen" Elevation="1" Anchor="Anchor.Start" Breakpoint="Breakpoint.Xl">
    @if (UserHasCommunity)
    {
        <MudDrawerHeader>
            <MudIcon Icon="@Icons.Material.Filled.Workspaces" />
            <MudSpacer />
            <MudText Typo="Typo.h6">AppState.User.Citizenships[0].Name</MudText>
        </MudDrawerHeader>
        <MudNavMenu>
            <MudNavLink Disabled="@CommunityMenuButtonDisabled">@AppState.Translate("Feed")</MudNavLink>
                <MudNavLink Disabled="@CommunityMenuButtonDisabled">@AppState.Translate("Create Proposal")</MudNavLink>
                <MudNavLink Disabled="@CommunityMenuButtonDisabled">@AppState.Translate("Accounting")</MudNavLink>
                <MudNavLink Disabled="@CommunityMenuButtonDisabled">@AppState.Translate("Constitution")</MudNavLink>
                <MudNavLink Disabled="@CommunityMenuButtonDisabled">@AppState.Translate("History")</MudNavLink>
                <MudNavLink Disabled="@CommunityMenuButtonDisabled">@AppState.Translate("Projects")</MudNavLink>
                <MudNavLink Disabled="@CommunityMenuButtonDisabled">@AppState.Translate("Roles")</MudNavLink>
                <MudNavLink Disabled="@CommunityMenuButtonDisabled">@AppState.Translate("Community")</MudNavLink>
                <MudNavLink Disabled="@CommunityMenuButtonDisabled">@AppState.Translate("AboutCommunity")</MudNavLink>
            </MudNavMenu>
    }
    else
    {
        <MudNavMenu>
            <MudNavLink Disabled="@CommunityMenuButtonDisabled">@AppState.Translate("JoinAnExistingCommunity")</MudNavLink>
            <MudNavLink Disabled="@CommunityMenuButtonDisabled">@AppState.Translate("RegisterANewCommunity")</MudNavLink>
        </MudNavMenu>
    }

</MudDrawer>

<MudDrawer @bind-Open="@userMenuOpen" Elevation="1" Anchor="Anchor.End" Breakpoint="Breakpoint.Xl">
    <MudDrawerHeader>
        <MudIcon Icon="@Icons.Material.Filled.Person" />
        <MudSpacer />
        <MudText Typo="Typo.h6">@if (AppState.User != null)
            {
                @AppState.User.FullName
            }</MudText>
        </MudDrawerHeader>
        <MudNavMenu>
        @if(!UserLoggedIn)
        {
            <MudNavLink>@AppState.Translate("LogIn")</MudNavLink>
            <MudNavLink>@AppState.Translate("SignUp")</MudNavLink>
            
        }
        else
        {
            <MudNavLink Disabled="@(AppState.User == null)">@AppState.Translate("Account")</MudNavLink>
            <MudNavLink Disabled="@(AppState.User == null)">@AppState.Translate("LogOut")</MudNavLink>
        }
        <MudNavLink Icon="@Icons.Material.Filled.Settings">@AppState.Translate("Settings")</MudNavLink>
        </MudNavMenu>
    </MudDrawer>